# ­ЪЈЌ№ИЈ Architecture Overview

## System Architecture

```
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ                         USER BROWSER                             Рћѓ
Рћѓ  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ  Рћѓ
Рћѓ  Рћѓ                    WEB PAGE (Any Form)                     Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рђб SmartRecruiters, Workday, Greenhouse, Custom forms     Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рђб React, Vue, Angular, Web Components                    Рћѓ  Рћѓ
Рћѓ  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў  Рћѓ
Рћѓ                              РєЋ                                   Рћѓ
Рћѓ  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ  Рћѓ
Рћѓ  Рћѓ            CHROME EXTENSION (Content Script)               Рћѓ  Рћѓ
Рћѓ  Рћѓ                                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ  dynamic-form-filler.js                            Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ                                                     Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ  ­ЪЊІ extractFormStructure()                         Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб Queries all inputs, selects, textareas      Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб Extracts labels, aria attributes            Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб Searches Shadow DOM                         Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб Checks iframes                              Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ                                                     Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ  ­Ъј» executeInstruction()                           Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб findElement() - Smart element finder        Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб fillField() - Universal field filler        Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб selectDropdownOption() - LLM-powered        Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  Рћѓ     Рђб uploadFile() - File System Access API       Рћѓ  Рћѓ  Рћѓ
Рћѓ  Рћѓ  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў  Рћѓ  Рћѓ
Рћѓ  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў  Рћѓ
Рћѓ                              РєЋ                                   Рћѓ
Рћѓ                    HTTP POST / WebSocket                         Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
                               РєЋ
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ                    PYTHON BACKEND SERVER                         Рћѓ
Рћѓ                      (localhost:8000)                            Рћѓ
Рћѓ  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ  Рћѓ
Рћѓ  Рћѓ                    server.py (FastAPI)                     Рћѓ  Рћѓ
Рћѓ  Рћѓ                                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ  ­Ъїљ REST API Endpoints:                                   Рћѓ  Рћѓ
Рћѓ  Рћѓ     POST /api/analyze-form                                Рћѓ  Рћѓ
Рћѓ  Рћѓ     POST /api/smart-dropdown                              Рћѓ  Рћѓ
Рћѓ  Рћѓ     POST /api/analyze-field                               Рћѓ  Рћѓ
Рћѓ  Рћѓ                                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ  ­Ъћї WebSocket:                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ     /ws - Real-time bidirectional communication          Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб Multi-step form guidance                           Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб Error recovery                                     Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб Progress updates                                   Рћѓ  Рћѓ
Рћѓ  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў  Рћѓ
Рћѓ                              РєЋ                                   Рћѓ
Рћѓ  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ  Рћѓ
Рћѓ  Рћѓ              form_analyzer.py (Core Logic)                 Рћѓ  Рћѓ
Рћѓ  Рћѓ                                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ  ­ЪЊЮ FormHTMLParser                                        Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб Parses form HTML structure                         Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб Extracts fields, labels, attributes                Рћѓ  Рћѓ
Рћѓ  Рћѓ                                                            Рћѓ  Рћѓ
Рћѓ  Рћѓ  ­ЪДа FormAnalyzer                                          Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб analyze_form() - Main analysis                     Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб _create_analysis_prompt() - LLM prompt builder     Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб select_dropdown_option() - Smart dropdown          Рћѓ  Рћѓ
Рћѓ  Рћѓ     Рђб get_alternative_strategy() - Error recovery        Рћѓ  Рћѓ
Рћѓ  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў  Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
                               РєЋ
                          API Calls
                               РєЋ
РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
Рћѓ                    DEDALUS + OPENAI GPT-4                        Рћѓ
Рћѓ                                                                  Рћѓ
Рћѓ  ­Ъцќ Model: openai/gpt-4o-mini                                   Рћѓ
Рћѓ  ­ЪЊі Task: Form structure understanding                          Рћѓ
Рћѓ  ­ЪњА Output: Intelligent field mappings + instructions           Рћѓ
РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
```

---

## Data Flow

### 1. Form Detection Flow

```
User clicks "Detect Form"
         РєЊ
Extension extracts form HTML:
{
  html: "<form><input name='firstName' />...</form>",
  url: "https://careers.example.com/apply"
}
         РєЊ
POST to /api/analyze-form
         РєЊ
Backend parses HTML Рєњ FormHTMLParser
         РєЊ
Creates LLM prompt with:
  Рђб Form structure
  Рђб User profile data
  Рђб Field context
         РєЊ
Sends to Dedalus Рєњ GPT-4o-mini
         РєЊ
LLM analyzes and returns:
{
  "form_type": "job_application",
  "confidence": 0.95,
  "field_mappings": [...],
  "instructions": [...]
}
         РєЊ
Extension receives analysis
         РєЊ
Shows: "Found 15 fields (95% confidence)"
```

### 2. Form Filling Flow

```
User clicks "Fill Form"
         РєЊ
Extension iterates through instructions
         РєЊ
For each instruction:
  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
  Рћѓ  1. Find element                Рћѓ
  Рћѓ     Рђб querySelector             Рћѓ
  Рћѓ     Рђб Shadow DOM search         Рћѓ
  Рћѓ     Рђб iframe search             Рћѓ
  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
         РєЊ
  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
  Рћѓ  2. Determine action            Рћѓ
  Рћѓ     Рђб fill Рєњ fillField()        Рћѓ
  Рћѓ     Рђб select Рєњ selectDropdown() Рћѓ
  Рћѓ     Рђб upload Рєњ uploadFile()     Рћѓ
  Рћѓ     Рђб click Рєњ clickElement()    Рћѓ
  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
         РєЊ
  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
  Рћѓ  3. Execute action              Рћѓ
  Рћѓ     Рђб Scroll into view          Рћѓ
  Рћѓ     Рђб Focus element             Рћѓ
  Рћѓ     Рђб Fill/Select value         Рћѓ
  Рћѓ     Рђб Dispatch events           Рћѓ
  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
         РєЊ
  РћїРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћљ
  Рћѓ  4. Verify & continue           Рћѓ
  Рћѓ     Рђб Mark as filled            Рћѓ
  Рћѓ     Рђб Notify via WebSocket      Рћѓ
  Рћѓ     Рђб Delay 800ms               Рћѓ
  РћћРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћђРћў
         РєЊ
All fields filled Рєњ Show success notification
```

### 3. Smart Dropdown Flow

```
Extension encounters dropdown
         РєЊ
Tries to open dropdown:
  Рђб Click trigger element
  Рђб Wait 500ms for options
         РєЊ
Extract visible options:
["0-1 years", "1-3 years", "3-5 years", "5+ years"]
         РєЊ
POST to /api/smart-dropdown:
{
  "options": [...],
  "desired_value": "5 years experience",
  "context": "Years of experience field"
}
         РєЊ
LLM analyzes:
  Рђб Compares desired value to options
  Рђб Handles abbreviations (USA Рєњ United States)
  Рђб Handles synonyms (Yes Рєњ I am authorized)
  Рђб Returns best match
         РєЊ
Returns:
{
  "selected_option": "5+ years",
  "confidence": 0.90,
  "reasoning": "User has 5 years, '5+ years' is best match"
}
         РєЊ
Extension clicks matching option
         РєЊ
Dropdown filled РюЊ
```

---

## Component Breakdown

### Chrome Extension Components

#### 1. dynamic-form-filler.js (580 lines)
**Main class:** `DynamicFormFiller`

**Key methods:**
- `extractFormStructure()` - Extracts HTML from page
- `detectAndAnalyzeForm()` - Sends to backend
- `fillFormIntelligently()` - Executes instructions
- `findElement()` - Smart element finder
- `fillField()` - Universal field filler
- `selectDropdownOption()` - Dropdown handler
- `uploadFile()` - File upload handler

**Special features:**
- Shadow DOM search
- iframe support
- React/Vue/Angular compatibility
- WebSocket real-time communication

#### 2. popup.js (122 lines)
**Purpose:** Extension popup UI

**Features:**
- Detect Form button
- Fill Form button
- Manage Profile button
- Status messages

#### 3. profile.js (200+ lines)
**Purpose:** User profile management

**Features:**
- Form for personal/professional info
- Auto-save (1s debounce)
- Export/Import JSON
- Resume file handling

#### 4. background.js (130 lines)
**Purpose:** Service worker

**Features:**
- Context menu items
- Message routing
- Settings management
- Tab update listeners

---

### Backend Components

#### 1. server.py (270 lines)
**Framework:** FastAPI

**Endpoints:**
```python
GET  /                     # Health check
POST /api/analyze-form     # Main form analysis
POST /api/smart-dropdown   # Dropdown selection
POST /api/analyze-field    # Single field analysis
WS   /ws                   # WebSocket connection
```

**Features:**
- CORS middleware for extension
- WebSocket connection manager
- Error handling
- Request/response validation

#### 2. form_analyzer.py (450 lines)
**Main class:** `FormAnalyzer`

**Key components:**

##### FormHTMLParser
```python
class FormHTMLParser(HTMLParser):
    def handle_starttag(self, tag, attrs):
        # Extract form elements

    def handle_data(self, data):
        # Capture label text
```

##### FormAnalyzer
```python
class FormAnalyzer:
    async def analyze_form(self, html, url, user_profile):
        # 1. Parse HTML
        # 2. Build context
        # 3. Create LLM prompt
        # 4. Get LLM response
        # 5. Parse and return

    async def select_dropdown_option(self, options, desired_value):
        # Use LLM for semantic matching

    async def get_alternative_strategy(self, error, field):
        # Suggest alternative on failure
```

---

## LLM Prompt Engineering

### Form Analysis Prompt Template

```python
f"""You are an intelligent form filling assistant. Analyze this form and provide field mappings.

FORM STRUCTURE:
{form_context}

AVAILABLE USER DATA:
{available_data}

TASK:
1. Identify each form field's purpose
2. Map each field to user data
3. For dropdowns, suggest best value
4. Provide CSS selectors
5. Indicate confidence level

Return JSON:
{{
  "form_type": "job_application" | "registration" | ...,
  "confidence": 0.0-1.0,
  "field_mappings": [
    {{
      "field_purpose": "first_name",
      "selector": "input[name='firstName']",
      "value": "John",
      "confidence": 0.95
    }}
  ],
  "instructions": [
    {{
      "step": 1,
      "action": "fill",
      "selector": "...",
      "value": "..."
    }}
  ]
}}
"""
```

### Dropdown Selection Prompt

```python
f"""Select the best matching option from this dropdown.

DROPDOWN CONTEXT: {context}
DESIRED VALUE: {desired_value}
AVAILABLE OPTIONS:
{options_list}

Consider:
- Exact matches
- Abbreviations (USA Рєњ United States)
- Synonyms (Yes Рєњ I am authorized)
- Common conventions

Return JSON:
{{
  "selected_option": "exact text",
  "confidence": 0.0-1.0,
  "reasoning": "why selected"
}}
"""
```

---

## Extension Permissions

### manifest.json

```json
{
  "permissions": [
    "activeTab",      // Access current tab
    "storage",        // Store user profile
    "tabs",           // Query tabs
    "scripting"       // Inject scripts
  ],
  "host_permissions": [
    "http://localhost:8000/*"  // Backend API access
  ]
}
```

---

## State Management

### Extension State

```javascript
class DynamicFormFiller {
  constructor() {
    this.userData = null;           // User profile
    this.currentAnalysis = null;    // LLM analysis result
    this.filledFields = new Set();  // Track filled fields
    this.isFilling = false;         // Prevent concurrent fills
    this.ws = null;                 // WebSocket connection
  }
}
```

### Backend State

```python
# In-memory state
active_connections: List[WebSocket] = []  # Active WS connections
form_analyzer: FormAnalyzer = None        # Analyzer instance
```

---

## Error Handling

### Extension Error Flow

```javascript
try {
  await this.fillField(element, value);
} catch (error) {
  console.error('Fill failed:', error);

  // Ask backend for alternative
  if (this.ws.readyState === WebSocket.OPEN) {
    this.ws.send(JSON.stringify({
      action: 'error',
      error: error.message,
      field: fieldData
    }));
  }

  // Backend responds with alternative strategy
  // Extension retries with alternative
}
```

### Backend Error Flow

```python
try:
    analysis = await form_analyzer.analyze_form(...)
    return FormAnalysisResponse(success=True, ...)

except Exception as e:
    logger.error(f"Analysis failed: {e}")
    return FormAnalysisResponse(
        success=False,
        error=str(e),
        field_mappings=[]  # Fallback to empty
    )
```

---

## Performance Optimizations

### 1. Caching (Potential)
```python
# Cache form analyses for same URL
cache = {}

def analyze_form(html, url):
    cache_key = hashlib.md5(html.encode()).hexdigest()

    if cache_key in cache:
        return cache[cache_key]

    result = await llm_analyze(html)
    cache[cache_key] = result
    return result
```

### 2. Batch Processing
```python
# Analyze multiple forms in parallel
async def batch_analyze(forms):
    tasks = [analyze_form(f) for f in forms]
    return await asyncio.gather(*tasks)
```

### 3. Lazy Loading
```javascript
// Only analyze when user clicks "Detect Form"
// Don't auto-analyze every page load
```

---

## Security Considerations

### 1. API Key Protection
```bash
# Backend .env file (never committed)
OPENAI_API_KEY=sk-...
DEDALUS_API_KEY=...
```

### 2. CORS Configuration
```python
# Only allow extension origin
app.add_middleware(
    CORSMiddleware,
    allow_origins=["chrome-extension://YOUR_ID"],
    allow_credentials=True
)
```

### 3. Input Validation
```python
class FormAnalysisRequest(BaseModel):
    html: str
    url: str
    user_profile: Dict[str, Any]

    @validator('html')
    def validate_html(cls, v):
        if len(v) > 1_000_000:  # 1MB limit
            raise ValueError('HTML too large')
        return v
```

### 4. Rate Limiting
```python
from slowapi import Limiter

limiter = Limiter(key_func=get_remote_address)

@app.post("/api/analyze-form")
@limiter.limit("10/minute")
async def analyze_form(...):
    ...
```

---

## Deployment Options

### Option 1: Local Development (Current)
```
Backend: localhost:8000
Extension: Load unpacked in Chrome
```

### Option 2: Cloud Backend
```
Backend: Deployed to AWS/GCP/Heroku
Extension: Updated manifest with cloud URL
```

### Option 3: Serverless
```
Backend: AWS Lambda + API Gateway
Extension: Calls Lambda functions
```

---

## Monitoring & Logging

### Backend Logs
```python
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

logger.info(f"Form analyzed: {url}")
logger.error(f"Analysis failed: {error}")
```

### Extension Logs
```javascript
console.log('­ЪћЇ Detecting form...');
console.log('­ЪЊі Analysis result:', analysis);
console.error('РЮї Error:', error);
```

---

## Testing Strategy

### 1. Unit Tests
```python
# backend/test_backend.py
async def test_form_analysis():
    analyzer = FormAnalyzer()
    result = await analyzer.analyze_form(sample_html)
    assert result['confidence'] > 0.8
```

### 2. Integration Tests
```javascript
// Test extension + backend communication
await detectForm();
assert(fieldCount > 0);
```

### 3. Manual Tests
- test-form.html - Generic form
- smartrecruiters-test.html - Real-world simulation

---

This architecture enables **zero-hardcoded, LLM-powered form filling** that works with ANY form! ­Ъџђ
